---
import BaseLayout from '../../layouts/BaseLayout.astro'
import Inscriptions from '../../components/svelte/site/inscriptions.svelte'
import {Content as Agenda} from './agenda/agenda.md'

//var data = await fetch(import.meta.env.PUBLIC_CMS + "acl-sections?_sort=titre:ASC&token=" + import.meta.env.PUBLIC_TOKEN_SITE)
var data = await fetch(import.meta.env.BASEROW_URL + "rows/table/651/?user_field_names=true", {headers: {Authorization: "Token " + import.meta.env.TOKEN_BASEROW_LECTURE}})
const sectionsTemp = await data.json()
const sections = sectionsTemp.results
//data = await fetch(import.meta.env.PUBLIC_CMS + "acl-professeurs?_sort=nom:ASC&token=" + import.meta.env.PUBLIC_TOKEN_SITE)
data = await fetch(import.meta.env.BASEROW_URL + "rows/table/650/?user_field_names=true", {headers: {Authorization: "Token " + import.meta.env.TOKEN_BASEROW_LECTURE}})
const professeursTemp = await data.json()
const professeurs = professeursTemp.results.map(prof => {return {prenom: prof.prenom, nom: prof.nom, acl_sections: prof.sections}})
data = await fetch(import.meta.env.BASEROW_URL + "rows/table/654/?user_field_names=true", {headers: {Authorization: "Token " + import.meta.env.TOKEN_BASEROW_LECTURE}})
const lesTarifsTemp = await data.json()
const lesTarifs = lesTarifsTemp.results.map((tarif) => {return {duree: tarif.duree_seance, tarif: tarif.tarif_acl, type: tarif.type}})
data = await fetch(import.meta.env.BASEROW_URL + "rows/table/655/?user_field_names=true", {headers: {Authorization: "Token " + import.meta.env.TOKEN_BASEROW_LECTURE}})
const adhesionsTarifsTemp = await data.json()
const adhesionsTarifs = adhesionsTarifsTemp.results.map((item) => {return {type: item.type, valeur: item.valeur, isSappey: item.isSappey, isFamiliale: item.isFamiliale}})
---
<BaseLayout title="Inscriptions">
  <h1 class="px-2 text-4xl mb-2">Inscriptions à l'école de musique</h1>
  <Agenda />
  <Inscriptions client:load {professeurs} {sections} {adhesionsTarifs} {lesTarifs}/>
</BaseLayout>

<style>
:global(.FM) {
  @apply flex flex-wrap gap-2 mb-4;
}

:global(.FM div) {
  @apply border border-vert-700 bg-vert-400/50 p-2 rounded;
}

:global(.FM div h3) {
  @apply font-semibold;
  @apply text-base text-vert-900 p-0 m-0;
}

:global(#formation-musicale) {
  font-weight: 600;
  @apply text-xl text-vert-900 p-0 m-0;
}

:global(.ateliers) {
  @apply flex flex-wrap gap-2 mb-4;
}

:global(.ateliers div) {
  @apply border border-bleu-700 bg-bleu-400/50 p-2 rounded;
}

:global(.ateliers div h3) {
  @apply font-semibold;
  @apply text-base text-bleu-900 p-0 m-0;
}

:global(#ateliers) {
  font-weight: 600;
  @apply text-xl text-bleu-900 p-0 m-0;
}


:global(.instruments) {
  @apply flex flex-wrap gap-2 mb-4;
}

:global(.instruments div) {
  @apply border border-jaune-700 bg-jaune-400/50 p-2 rounded;
}

:global(.instruments div h3) {
  @apply font-semibold;
  @apply text-base text-jaune-900 p-0 m-0;
}

:global(#instruments) {
  font-weight: 600;
  @apply text-xl text-jaune-900 p-0 m-0;
}
</style>